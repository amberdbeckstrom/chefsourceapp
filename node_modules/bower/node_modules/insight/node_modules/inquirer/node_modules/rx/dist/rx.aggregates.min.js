(function(t){var e={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},n=e[typeof window]&&window||this,r=e[typeof exports]&&exports&&!exports.nodeType&&exports,i=e[typeof module]&&module&&!module.nodeType&&module,o=(i&&i.exports===r&&r,e[typeof global]&&global);!o||o.global!==o&&o.window!==o||(n=o),"function"==typeof define&&define.amd?define(["rx","exports"],function(e,r){return n.Rx=t(n,r,e),n.Rx}):"object"==typeof module&&module&&module.exports===r?module.exports=t(n,module.exports,require("./rx")):n.Rx=t(n,{},n.Rx)}).call(this,function(t,e,n,r){function i(t,e,n){return new m(function(i){var o=!1,s=null,u=[];return t.subscribe(function(t){var c,a;try{a=e(t)}catch(h){return i.onError(h),r}if(c=0,o)try{c=n(a,s)}catch(f){return i.onError(f),r}else o=!0,s=a;c>0&&(s=a,u=[]),c>=0&&u.push(t)},i.onError.bind(i),function(){i.onNext(u),i.onCompleted()})})}function o(t){if(0===t.length)throw Error(S);return t[0]}function s(t,e,n){return new m(function(i){var o=0,s=e.length;return t.subscribe(function(t){var u=!1;try{s>o&&(u=n(t,e[o++]))}catch(c){return i.onError(c),r}u||(i.onNext(!1),i.onCompleted())},i.onError.bind(i),function(){i.onNext(o===s),i.onCompleted()})})}function u(t,e,n,r){if(0>e)throw Error(D);return new m(function(i){var o=e;return t.subscribe(function(t){0===o&&(i.onNext(t),i.onCompleted()),o--},i.onError.bind(i),function(){n?(i.onNext(r),i.onCompleted()):i.onError(Error(D))})})}function c(t,e,n){return new m(function(r){var i=n,o=!1;return t.subscribe(function(t){o?r.onError(Error("Sequence contains more than one element")):(i=t,o=!0)},r.onError.bind(r),function(){o||e?(r.onNext(i),r.onCompleted()):r.onError(Error(S))})})}function a(t,e,n){return new m(function(r){return t.subscribe(function(t){r.onNext(t),r.onCompleted()},r.onError.bind(r),function(){e?(r.onNext(n),r.onCompleted()):r.onError(Error(S))})})}function h(t,e,n){return new m(function(r){var i=n,o=!1;return t.subscribe(function(t){i=t,o=!0},r.onError.bind(r),function(){o||e?(r.onNext(i),r.onCompleted()):r.onError(Error(S))})})}function f(t,e,n,i){return new m(function(o){var s=0;return t.subscribe(function(u){var c;try{c=e.call(n,u,s,t)}catch(a){return o.onError(a),r}c?(o.onNext(i?s:u),o.onCompleted()):s++},o.onError.bind(o),function(){o.onNext(i?-1:r),o.onCompleted()})})}function l(t,e){return new m(function(n){var r=new e;return t.subscribe(r.add.bind(r),n.onError.bind(n),function(){n.onNext(r),n.onCompleted()})})}function p(t,e,n,i){return new m(function(o){var s=new e;return t.subscribe(function(t){var e;try{e=n(t)}catch(u){return o.onError(u),r}var c=t;if(i)try{c=i(t)}catch(u){return o.onError(u),r}s.set(e,c)},o.onError.bind(o),function(){o.onNext(s),o.onCompleted()})})}var d=n.Observable,b=d.prototype,v=n.CompositeDisposable,m=n.AnonymousObservable,y=(n.internals.isEqual,n.helpers),w=y.not,g=y.defaultComparer,E=y.identity,x=y.defaultSubComparer,C=y.isPromise,N=d.fromPromise,D="Argument out of range",S="Sequence contains no elements.";return b.finalValue=function(){var t=this;return new m(function(e){var n,r=!1;return t.subscribe(function(t){r=!0,n=t},e.onError.bind(e),function(){r?(e.onNext(n),e.onCompleted()):e.onError(Error(S))})})},b.aggregate=function(){var t,e,n;return 2===arguments.length?(t=arguments[0],e=!0,n=arguments[1]):n=arguments[0],e?this.scan(t,n).startWith(t).finalValue():this.scan(n).finalValue()},b.reduce=function(t){var e,n;return 2===arguments.length&&(n=!0,e=arguments[1]),n?this.scan(e,t).startWith(e).finalValue():this.scan(t).finalValue()},b.some=b.any=function(t,e){var n=this;return t?n.where(t,e).any():new m(function(t){return n.subscribe(function(){t.onNext(!0),t.onCompleted()},t.onError.bind(t),function(){t.onNext(!1),t.onCompleted()})})},b.isEmpty=function(){return this.any().map(w)},b.every=b.all=function(t,e){return this.where(function(e){return!t(e)},e).any().select(function(t){return!t})},b.contains=function(t,e){return e||(e=g),this.where(function(n){return e(n,t)}).any()},b.count=function(t,e){return t?this.where(t,e).count():this.aggregate(0,function(t){return t+1})},b.sum=function(t,e){return t?this.select(t,e).sum():this.aggregate(0,function(t,e){return t+e})},b.minBy=function(t,e){return e||(e=x),i(this,t,function(t,n){return-1*e(t,n)})},b.min=function(t){return this.minBy(E,t).select(function(t){return o(t)})},b.maxBy=function(t,e){return e||(e=x),i(this,t,e)},b.max=function(t){return this.maxBy(E,t).select(function(t){return o(t)})},b.average=function(t,e){return t?this.select(t,e).average():this.scan({sum:0,count:0},function(t,e){return{sum:t.sum+e,count:t.count+1}}).finalValue().select(function(t){if(0===t.count)throw Error("The input sequence was empty");return t.sum/t.count})},b.sequenceEqual=function(t,e){var n=this;return e||(e=g),Array.isArray(t)?s(n,t,e):new m(function(i){var o=!1,s=!1,u=[],c=[],a=n.subscribe(function(t){var n,o;if(c.length>0){o=c.shift();try{n=e(o,t)}catch(a){return i.onError(a),r}n||(i.onNext(!1),i.onCompleted())}else s?(i.onNext(!1),i.onCompleted()):u.push(t)},i.onError.bind(i),function(){o=!0,0===u.length&&(c.length>0?(i.onNext(!1),i.onCompleted()):s&&(i.onNext(!0),i.onCompleted()))});C(t)&&(t=N(t));var h=t.subscribe(function(t){var n,s;if(u.length>0){s=u.shift();try{n=e(s,t)}catch(a){return i.onError(a),r}n||(i.onNext(!1),i.onCompleted())}else o?(i.onNext(!1),i.onCompleted()):c.push(t)},i.onError.bind(i),function(){s=!0,0===c.length&&(u.length>0?(i.onNext(!1),i.onCompleted()):o&&(i.onNext(!0),i.onCompleted()))});return new v(a,h)})},b.elementAt=function(t){return u(this,t,!1)},b.elementAtOrDefault=function(t,e){return u(this,t,!0,e)},b.single=function(t,e){return t?this.where(t,e).single():c(this,!1)},b.singleOrDefault=function(t,e,n){return t?this.where(t,n).singleOrDefault(null,e):c(this,!0,e)},b.first=function(t,e){return t?this.where(t,e).first():a(this,!1)},b.firstOrDefault=function(t,e){return t?this.where(t).firstOrDefault(null,e):a(this,!0,e)},b.last=function(t,e){return t?this.where(t,e).last():h(this,!1)},b.lastOrDefault=function(t,e,n){return t?this.where(t,n).lastOrDefault(null,e):h(this,!0,e)},b.find=function(t,e){return f(this,t,e,!1)},b.findIndex=function(t,e){return f(this,t,e,!0)},t.Set&&(b.toSet=function(){return l(this,t.Set)}),t.WeakSet&&(b.toSet=function(){return l(this,t.WeakSet)}),t.Map&&(b.toMap=function(e,n){return p(this,t.Map,e,n)}),t.WeakMap&&(b.toWeakMap=function(e,n){return p(this,t.WeakMap,e,n)}),n});